//<!--
//             Copyright obout inc       http://www.obout.com
//     
//             JavaScript file version 2005.10.06

// false - when dragging show moving node itself without children.
// true - when dragging show moving node with children.
var show_with_children= true;

var d_O,d_o,d_Y=0,d_y=0,d_I= false ,d_i=null,d_A=null,tree_dd_path="",tree_dd_id="",d_a=0,d_E=0,d_e= true ,d_U=0,d_u=0,d_Z; function d_z(event){if (d_e== true){if (window.event){var event=window.event; d_a=event.x; d_E=event.y; }else {d_a=event.pageX; d_E=event.pageY; }d_e= false; return; }else {if (window.event){var event=window.event; d_U=event.x; d_u=event.y; }else {d_U=event.pageX; d_u=event.pageY; }}if ((Math.abs(d_U-d_a)>5) || (Math.abs(d_u-d_E)>5)){}else {return; }if (d_I== false)return; if (d_i==null){if (show_with_children== true){d_i=d_A.cloneNode( true); d_i.firstChild.firstChild.firstChild.firstChild.style.display="none"; if (d_i.firstChild.nextSibling!=null){d_i.firstChild.nextSibling.firstChild.firstChild.firstChild.style.display="none"; }}else {d_i=d_A.firstChild.cloneNode( true); document.body.appendChild(d_i); d_i.firstChild.firstChild.firstChild.style.display="none"; }document.body.appendChild(d_i); d_i.style.position="absolute"; d_i.style.zIndex="0"; d_i.style.filter="Alpha(Opacity='70',FinishOpacity='0',Style='1',StartX='0',StartY='0',FinishX='100',FinishY='100')"; d_i.style.opacity=.7; d_i.id="ob_drag"; if (window.event){d_Y=document.body.scrollLeft; d_y=document.body.scrollTop; }else {d_O=event.pageX; d_o=event.pageY; }}if (window.event){var event=window.event; d_i.style.left=event.x+d_Y-5; d_i.style.top=event.y+d_y-5; }else {d_i.style.left=event.pageX-5; d_i.style.top=event.pageY-5; }var top=d_X(d_Z); var bottom=top+d_Z.offsetHeight; if ((d_i.offsetTop-top)<024 && d_Z.scrollTop>0){d_Z.scrollTop=d_Z.scrollTop-6; }if ((bottom-d_i.offsetTop)<024){d_Z.scrollTop=d_Z.scrollTop+6; }var p=event?event.clientY:window.event.y; var d_x=window.innerHeight || document.body.clientHeight; var d_W=window.pageXOffset || document.body.scrollLeft; var d_w=window.pageYOffset || document.body.scrollTop; if (p<050){var td=d_w-top; td=td<014?td: 014; if (td>0){window.scrollTo(d_W,d_w-td); if (window.event){d_i.style.posTop+=td; d_y=document.body.scrollTop; }}}if ((d_x-p)<050){var d_V=bottom-(d_w+d_x); d_V=d_V<014?d_V: 014; if (d_V>0){window.scrollTo(d_W,d_w+d_V); if (window.event){d_i.style.posTop-=d_V; d_y=document.body.scrollTop; }}}}function ob_t10(event,d_v){

// EVENT. Before Drag start.

d_Z=document.getElementById(ob_tree_id); d_I= true; d_A=d_v.parentNode; document.onmousemove= function (d_T){d_z(d_T);} ; document.onmouseup= function (d_T){d_t(d_T);} ; document.onselectstart= function (){return false; } ; document.onmousedown= function (){return false; } ; }function ob_t12(){d_I= false; document.onmousemove=null; document.onselectstart= function (){return true; } ; document.onmousedown= function (){return true; } ; }function d_t(event){var d_T,d_S,s,d_s= false ,d_R; d_e= true; if (d_i==null){return; }if (window.event){var event=window.event; var d_r=event.x+d_Y; var d_Q=event.y+d_y; }else {var d_r=event.pageX; var d_Q=event.pageY; }d_q=document.getElementById(ob_tree_id); do {d_q=d_q.parentNode; if (d_q!=null && d_q!=document.body){if (typeof(d_q.scrollLeft)!="undefined")d_r+=d_q.scrollLeft; if (typeof(d_q.scrollTop)!="undefined")d_Q+=d_q.scrollTop; }else break; }while ( true); var d_P,d_p= false; d_i.style.display="none"; d_N=document.getElementsByTagName("TABLE"); for (i=0; i<d_N.length; i++){var top=d_X(d_N[i])-d_Z.scrollTop; var left=d_n(d_N[i])-d_Z.scrollLeft; if (d_N[i].tagName=="TABLE" && (d_Q>=top && d_Q<=d_N[i].offsetHeight+top) && (d_r>=left && d_r<=d_N[i].offsetWidth+left)){d_P=d_N[i]; if (d_P==d_A.firstChild){d_P=null;

alert("Can not move. The destination is the same as the source.");

}}}if (d_P!=null){if (d_P.parentNode.tagName=="DIV"){if (d_P.firstChild.firstChild.childNodes.length==3){if (d_P.firstChild.firstChild.firstChild.firstChild.tagName=="IMG"){s=d_P.firstChild.firstChild.firstChild.firstChild.src.toLowerCase(); d_S=(s.length-6); s=s.substr(d_S,6); if ((s=="ik.gif") || (s=="hr.gif") || (s=="_l.gif") || (s=="us.gif")){var d_M=d_P.parentNode.lastChild.firstChild.firstChild.lastChild.className; if ((d_M!="ob_t7") && (d_M!="none")){}else {

alert("Can not drop to root of dynamically loaded subtree.");

d_p= true; }}else {d_p= true; }}else {d_p= true; }}else {d_p= true; }}else {d_p= true; }}if (d_p== true)d_P=null; if (d_P!=null){d_T=d_P.firstChild.firstChild.firstChild.nextSibling.nextSibling; tree_dd_path=""; d_m(d_T); var d_L=tree_dd_path.split("|"); var d_l=d_A.firstChild.firstChild.firstChild.firstChild.nextSibling.nextSibling.id; for (i=0; i<d_L.length; i++){if (d_L[i]==d_l){d_P=null;

alert("Can not move. The destination is under the source.");

}}}if (d_P!=null){if (d_P.parentNode.childNodes.length>1){if (d_P.nextSibling==d_A.parentNode.parentNode.parentNode.parentNode){d_P=null;

alert("Can not move. The destination is the same as the source.");

}}}if (d_P!=null){var ob_dd_target_id=d_P.firstChild.firstChild.firstChild.nextSibling.nextSibling.id; if (sNoDrop!=""){var a=new Array; a=sNoDrop.split(","); if (a.length>0){for (i=0; i<a.length; i++){if (ob_dd_target_id==a[i]){d_P=null;

alert("Can not move. The destination folder is restricted.");

}}}}}d_i.style.display="block"; if (d_P!=null){d_T=d_A.firstChild.firstChild.firstChild.firstChild.firstChild; d_T.src=d_K(d_T); d_T.parentNode.style.backgroundImage="none"; d_A.firstChild.firstChild.firstChild.firstChild.style.backgroundImage="none"; if (d_A.childNodes.length==2){d_A.firstChild.nextSibling.firstChild.firstChild.firstChild.style.backgroundImage="none"; }if (d_P.parentNode.childNodes.length==1){d_T=d_P.firstChild.firstChild.firstChild.firstChild; d_T.src=ob_style+"/minus_l.gif"; d_T.onclick= function (){ob_t21(this,"");} ; d_T=d_P.parentNode.appendChild(document.createElement("TABLE")); if (document.all){d_T.border="0"; d_T.cellPadding="0"; d_T.cellSpacing="0"; }else {d_T.setAttribute("border","0"); d_T.setAttribute("cellpadding","0"); d_T.setAttribute("cellspacing","0"); }d_T.appendChild(document.createElement("tbody")); var d_k=d_T.firstChild.appendChild(document.createElement("TR")); d_T=d_k.appendChild(document.createElement("TD")); if (d_P.parentNode.parentNode.lastChild!=d_P.parentNode){d_T.style.backgroundImage="url("+ob_style+"/vertical.gif)"; }d_T.innerHTML="<div class=ob_d5></div>"; d_T=d_k.appendChild(document.createElement("TD")); d_T.className="ob_t5"; }else {d_T=d_P.nextSibling.firstChild.firstChild.firstChild.nextSibling; if (d_T.lastChild.childNodes.length>1){d_T.lastChild.firstChild.nextSibling.firstChild.firstChild.firstChild.style.backgroundImage="url("+ob_style+"/vertical.gif)"; d_T.lastChild.firstChild.firstChild.firstChild.firstChild.style.backgroundImage="url("+ob_style+"/vertical.gif)"; d_k=d_T.lastChild.firstChild.firstChild.firstChild.firstChild.firstChild; s=d_k.src; d_S=(s.length-6); d_R=s.substr(d_S,6); if (d_R=="_l.gif"){d_R=s.substr(0,d_S)+".gif"; d_k.src=d_R; d_k.onclick= function (){ob_t21(this,"");} ; }}else {d_k=d_T.lastChild.firstChild.firstChild.firstChild.firstChild.firstChild; d_k.src=ob_style+"/hr.gif"; d_s= true; }}var d_J=d_T; document.body.removeChild(d_i); var ob_dd_id=d_A.firstChild.firstChild.firstChild.firstChild.nextSibling.nextSibling.id; tree_dd_id=tree_dd_id+ob_dd_target_id+","+ob_dd_id+"|"; if (d_A.parentNode.childNodes.length==1){d_T=d_A.parentNode.parentNode.parentNode.parentNode.parentNode; if (d_s== false){d_T.firstChild.firstChild.firstChild.firstChild.firstChild.src=ob_style+"/hr_l.gif"; }else {d_T.firstChild.firstChild.firstChild.firstChild.firstChild.src=ob_style+"/hr.gif"; }d_T.removeChild(d_T.firstChild.nextSibling); }else {if (d_A.parentNode.lastChild==d_A){d_T=d_A.previousSibling.firstChild.firstChild.firstChild.firstChild.firstChild; d_T.src=d_K(d_T); d_T.parentNode.style.backgroundImage="none"; if (d_A.previousSibling.childNodes.length>1){d_A.previousSibling.firstChild.nextSibling.firstChild.firstChild.firstChild.style.backgroundImage="none"; }else {}}}document.onmousemove=""; d_T=d_P.firstChild.firstChild.firstChild.firstChild; d_S=(d_T.src.length-8); s=d_T.src.substr(d_S,8); if ((s=="usik.gif") || (s=="ik_l.gif")){d_T.onclick(); }d_J.appendChild(d_A); }else {document.body.removeChild(document.getElementById("ob_drag")); }d_i=null; d_I= false; document.onselectstart= function (){return true; } ; document.onmousedown= function (){return true; } ; document.onmouseup=null;

// EVENT. After Drag & Drop finished.

}function d_n(d_j){var d_H=0; if (d_j.offsetParent){while (d_j.offsetParent){d_H+=d_j.offsetLeft; d_j=d_j.offsetParent; }}else if (d_j.x)d_H+=d_j.x; return d_H; }function d_X(d_h){var d_H=0; if (d_h.offsetParent){while (d_h.offsetParent){d_H+=d_h.offsetTop; d_h=d_h.offsetParent; }}else if (d_h.y)d_H+=d_h.y; return d_H; }function ob_t18(s){if (document.all){var d_N=s.getElementsByTagName("IMG"); for (var i=0; i<d_N.length; i++){d_N[i].ondragstart= function (){return false; } ; }}var d_T; var d_N=s.getElementsByTagName("DIV"); for (i=0; i<d_N.length; i++){var d_G= false; if (d_N[i].className==""){try {if (d_N[i].firstChild.firstChild.firstChild.lastChild.className=="ob_t2"){d_G= true; }}catch (d_T){}}if ((d_N[i].className=="ob_t2b") || (d_N[i].className=="ob_t2c") || d_G){d_T=d_N[i].firstChild; if (document.all){d_T.onmousedown=new Function("ob_t10(null,this);"); d_T.onmouseup=new Function("ob_t12();"); }else {d_T.setAttribute("onmousedown","ob_t10(event,this);"); d_T.setAttribute("onmouseup","ob_t12();"); }}}}function d_m(d_T){if (d_T.parentNode.parentNode.parentNode.parentNode.parentNode.className=="ob_di2"){return; } ; d_T=d_T.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.firstChild.firstChild.firstChild.firstChild.nextSibling.nextSibling; tree_dd_path=d_T.id+"|"+tree_dd_path; d_m(d_T); }function ob_tnodrag(s){if (s==""){return; }var a=new Array; a=s.split(","); for (var i=0; i<a.length; i++){d_T=document.getElementById(a[i]).parentNode.parentNode.parentNode; d_T.onmousedown= function (){return false; } ; d_T.onmouseup= function (){return false; } ; }}function d_K(d_T){if (!d_T.onclick)d_T.onclick= function (){ob_t21(this,"");} ; var s="",d_S=0,d_R=""; s=d_T.src; d_S=(s.length-6); d_R=s.substr(d_S,6); if (d_R!="_l.gif"){d_R=s.substr(0,d_S+2)+"_l.gif"; return d_R; }else {return s; }}
//-->